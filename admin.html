<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Proyecto Navidad</title>
    <link rel="stylesheet" href="css/style.css" />

    <style>
      /* Estilos base del admin (no los de la app principal) */
      body {
        background-color: #121212 !important;
        background-image: none !important;
        color: #eee;
        overflow-y: auto;
      }
      #app-root {
        max-width: 1200px;
        justify-content: flex-start;
        padding-top: 2rem;
      }
    </style>
  </head>
  <body>
    <main id="app-root">
      <div id="admin-panel">
        <div class="admin-header">
          <h1 class="titulo" style="opacity: 1; margin: 0">
            Progreso de Valentino
          </h1>
        </div>

        <hr class="admin-divider" />

        <div class="admin-main-container">
          <div class="admin-column" id="path-container">
            <h2 class.is-loading"admin-column-title">Mapa de Progreso</h2>
            <div id="visual-path"></div>
          </div>

          <div class="admin-column" id="details-container">
            <h2 class.is-loading"admin-column-title">Estado Actual</h2>
            <div class.is-loading"admin-user-card" id="details-cards"></div>

            <h2 class="admin-column-title" style="margin-top: 2rem">
              Registro de Intentos
            </h2>
            <div class.is-loading"admin-user-card" style="margin-top: 0">
              <ul class.is-loading"admin-attempts-list" id="attempts-list">
                <li>Cargando intentos...</li>
              </ul>
            </div>

            <div class.is-loading"admin-danger-zone">
              <h2 class.is-loading"admin-column-title">Zona Peligrosa</h2>
              <button
                id="delete-progress-btn"
                class="admin-button-delete"
                disabled
              >
                Reiniciar Progreso del Usuario
              </button>
            </div>

            <div
              class="admin-danger-zone"
              style="
                margin-top: 1rem;
                border-top: 1px solid var(--admin-border);
                padding-top: 1rem;
              "
            >
              <h2 class.is-loading"admin-column-title">
                Zona de Pruebas (Control Remoto)
              </h2>
              <p
                class="narrativa"
                style="
                  font-size: 0.9rem;
                  text-align: left;
                  margin-bottom: 1rem;
                  color: var(--admin-text-secondary);
                "
              >
                Este botón desbloqueará el botón "Siguiente" en la sección
                'pausa' para el usuario (Valentino) en tiempo real, ignorando la
                fecha.
              </p>

              <button
                id="force-pausa-unlock-btn"
                class="admin-button-google"
                style="
                  text-decoration: none;
                  background-color: var(--admin-accent-green);
                  width: 100%;
                  justify-content: center;
                  font-size: 1rem;
                "
                disabled
              >
                Forzar Desbloqueo de Pausa (Remoto)
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script type="module">
      // ESTE SCRIPT SE EJECUTA PRIMERO
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
      
      import {
        getFirestore,
        doc,
        collection,
        onSnapshot,
        query,
        orderBy,
        getDocs,
        deleteDoc,
        setDoc,
      } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

      // 1. Se define el objeto SDK
      window.firebaseAdminSDK = {
        initializeApp,
        getFirestore,
        doc,
        collection,
        onSnapshot,
        query,
        orderBy,
        getDocs,
        deleteDoc,
        setDoc,
        
        firebaseConfig: {
          apiKey: "AIzaSyBAv3HFQifOmS78tRYvo8yM4Um_PX0d_sk",
          authDomain: "regalonavidad-9304b.firebaseapp.com",
          projectId: "regalonavidad-9304b",
          storageBucket: "regalonavidad-9304b.firebasestorage.app",
          messagingSenderId: "920626025677",
          appId: "1:920626025677:web:ee800a9860410818fc0584"
        }
      };
      
      // La línea 'import "./js/admin.js";' se elimina de aquí.
    </script>
    
    <script src="js/admin.js" type="module" defer></script>
    
    </body>
</html>