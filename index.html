<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no"
    />
    <title>Regalo</title>

    <!-- Preload critical fonts -->
    <link
      rel="preload"
      href="https://db.onlinewebfonts.com/c/bcd0c9bdcf29c2dd630785c724469553?family=Verlag-Book"
      as="style"
    />
    <link
      rel="preload"
      href="https://db.onlinewebfonts.com/c/ddee8efcace361d6aab1d9b0473cd521?family=Verlag-Light"
      as="style"
    />

    <!-- Font stylesheets -->
    <link
      href="https://db.onlinewebfonts.com/c/bcd0c9bdcf29c2dd630785c724469553?family=Verlag-Book"
      rel="stylesheet"
    />
    <link
      href="https://db.onlinewebfonts.com/c/ddee8efcace361d6aab1d9b0473cd521?family=Verlag-Light"
      rel="stylesheet"
    />

    <!-- Favicon -->
    <link
      rel="icon"
      href="data:image/svg+xml,&lt;svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'&gt;&lt;text y='0.9em' font-size='90'&gt;🎁&lt;/text&gt;&lt;/svg&gt;"
    />

    <!-- Main stylesheet -->
    <link rel="stylesheet" href="css/style.css" />
  </head>

  <body>
    <!-- Background and overlay layers -->
    <div class="vignette"></div>
    <div id="fadeOverlay"></div>
    <div class="background"></div>
    <canvas id="bokehCanvas"></canvas>

    <!-- Global audio elements -->
    <audio id="audio-fondo" preload="auto" loop>
      <source src="assets/audio/background.mp3" type="audio/mpeg" />
    </audio>

    <!-- Intro Section -->
    <div id="intro" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="play-center">
          <button type="button">▶</button>
          <p class="aviso-volumen">🔊 Sube el volumen antes de empezar</p>
        </div>

        <div class="acciones"></div>

        <audio id="audio-intro" preload="auto">
          <source src="assets/audio/intro.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <!-- Decision Section -->
    <div id="decision" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="acciones"></div>
        <div class="replay-button"></div>
        <audio id="audio-decision" preload="auto">
          <source src="assets/audio/decision.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <!-- Confirmation Sections -->
    <div id="confirmacion1" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="acciones"></div>
        <div class="replay-button"></div>
        <audio id="audio-confirmacion1" preload="auto">
          <source src="assets/audio/confirmacion1.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <div id="confirmacion2" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="acciones"></div>
        <div class="replay-button"></div>
        <audio id="audio-confirmacion2" preload="auto">
          <source src="assets/audio/confirmacion2.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <!-- Puzzle Sections -->
    <div id="acertijo1" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="input-group">
          <div>
            <input
              id="respuesta1"
              type="text"
              placeholder="Tu respuesta"
              autocomplete="off"
            />
            <button class="send-button">Enviar</button>
          </div>
          <div id="error1" class="mensaje-error"></div>
        </div>
        <div class="replay-button"></div>
        <audio id="audio-acertijo1" preload="auto">
          <source src="assets/audio/acertijo1.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <div id="acertijo2" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="input-group">
          <div>
            <input
              id="respuesta2"
              type="text"
              placeholder="Tu respuesta"
              autocomplete="off"
            />
            <button class="send-button">Enviar</button>
          </div>
          <div id="error2" class="mensaje-error"></div>
        </div>
        <div class="replay-button"></div>
        <audio id="audio-acertijo2" preload="auto">
          <source src="assets/audio/acertijo2.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <div id="acertijo3" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="input-group">
          <div>
            <input
              id="respuesta3"
              type="text"
              placeholder="Tu respuesta"
              autocomplete="off"
            />
            <button class="send-button">Enviar</button>
          </div>
          <div id="error3" class="mensaje-error"></div>
        </div>
        <div class="replay-button"></div>
        <audio id="audio-acertijo3" preload="auto">
          <source src="assets/audio/acertijo3.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <!-- Explanation Sections -->
    <div id="explicacion1" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="acciones"></div>
        <div class="replay-button"></div>
        <audio id="audio-explicacion1" preload="auto">
          <source src="assets/audio/explicacion1.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <div id="explicacion2" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="acciones"></div>
        <div class="replay-button"></div>
        <audio id="audio-explicacion2" preload="auto">
          <source src="assets/audio/explicacion2.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <div id="explicacion3" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="acciones"></div>
        <div class="replay-button"></div>
        <audio id="audio-explicacion3" preload="auto">
          <source src="assets/audio/explicacion3.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <!-- Final Video Section -->
    <div id="final" class="section Final-section">
      <div class="video-container">
        <video id="Final" preload="auto" playsinline>
          <source src="assets/video/final.mp4" type="video/mp4" />

          Tu navegador no soporta el elemento video.
        </video>
        <div id="video-play-overlay"></div>
      </div>
      <div class="controles">
        <div class="acciones"></div>
        <div class="replay-button"></div>
      </div>
      <!-- Audio navideño que se reproduce durante el video -->
      <audio id="audio-fondo-navidad" preload="auto" loop>
        <source src="assets/audio/background_video.mp3" type="audio/mpeg" />
      </audio>
    </div>

    <!-- Final Gift Section -->
    <div id="countdown" class="section final-regalo-section">
      <!-- Cuenta regresiva -->
      <div class="countdown-container-vertical">
        <div class="countdown-title"></div>
        <div id="countdown" class="countdown-display-vertical">
          <div class="countdown-unit">
            <span id="years">0</span>
            <label>años</label>
          </div>
          <div class="countdown-unit">
            <span id="days">0</span>
            <label>días</label>
          </div>
          <div class="countdown-unit">
            <span id="hours">0</span>
            <label>horas</label>
          </div>
          <div class="countdown-unit">
            <span id="minutes">0</span>
            <label>minutos</label>
          </div>
          <div class="countdown-unit">
            <span id="seconds">0</span>
            <label>segundos</label>
          </div>
        </div>
      </div>
      <div class="controles">
        <div class="replay-button"></div>
        <!-- Audio de fondo final que se reproduce en countdown -->
        <audio id="audio-fondo-final" preload="auto" loop>
          <source src="assets/audio/background-final.mp3" type="audio/mpeg" />
        </audio>
        <!-- Audio de narración para countdown (si existe) -->
        <audio id="audio-countdown" preload="auto">
          <source src="assets/audio/background-final.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <!-- Final Alternative Section -->
    <div id="final2" class="section">
      <div class="titulo">
        <h1></h1>
      </div>
      <div class="contenido">
        <div class="narrativa"></div>
      </div>
      <div class="controles">
        <div class="replay-button"></div>
        <audio id="audio-final2" preload="auto">
          <source src="assets/audio/final2.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </div>

    <!-- JavaScript modules -->

    <!-- AGREGAR esta línea ANTES de los otros scripts -->
    <script src="js/error-handler.js"></script>
    <!-- Después de todos tus otros scripts, agregar TEMPORALMENTE -->
    <script src="js/diagnostico-debug.js"></script>
    <!-- Scripts existentes (mantener el orden) -->
    <script src="js/bokeh.js"></script>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/audio-manager.js"></script>
    <script src="js/navigation.js"></script>
    <!-- ESTE SE REEMPLAZA -->
    <script src="js/validation.js"></script>
    <script src="js/content-manager.js"></script>
    <script src="js/countdown.js"></script>
    <script src="js/main.js"></script>
    <!-- ESTE SE ACTUALIZA -->
    <script src="js/dev-tools.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        try {
          App.init();
          DevTools.init();
        } catch (error) {
          console.error("Error al inicializar la aplicación:", error);
        }
      });
    </script>
  </body>
</html>
